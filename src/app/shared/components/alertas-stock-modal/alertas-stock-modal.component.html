<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-title><strong>Alertas de stock</strong></ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="cerrar()" aria-label="Cerrar">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
  <ion-toolbar color="light">
    <ion-buttons slot="end">
      <ion-button (click)="verTodas()" fill="clear" size="small">Ver todas</ion-button>
    </ion-buttons>
  </ion-toolbar>
  </ion-header>

<ion-content>
  <div class="estado" *ngIf="cargando">
    <ion-spinner name="crescent"></ion-spinner>
    <span>Cargando alertas…</span>
  </div>

  <div class="estado error" *ngIf="!cargando && error">{{ error }}</div>
  <div class="estado" *ngIf="!cargando && !error && alertas.length === 0">No hay productos con bajo stock</div>

  <ion-list *ngIf="!cargando && !error && alertas.length > 0">
    <ion-item *ngFor="let a of alertas">
      <ion-label>
        <h2>{{ a.nombre }}</h2>
        <p>
          SKU: {{ a.sku }}
          <span *ngIf="a.categoria"> · {{ a.categoria }}</span>
        </p>
        <p>
          Stock actual: <strong [class.peligro]="a.stock_actual <= a.stock_minimo">{{ a.stock_actual }}</strong>
          · Mínimo: {{ a.stock_minimo }}
        </p>
      </ion-label>
      <ion-badge slot="end" color="danger" *ngIf="a.stock_actual <= a.stock_minimo">Bajo</ion-badge>
      <ion-badge slot="end" color="warning" *ngIf="a.stock_actual > a.stock_minimo">Atento</ion-badge>
    </ion-item>
  </ion-list>
</ion-content>
